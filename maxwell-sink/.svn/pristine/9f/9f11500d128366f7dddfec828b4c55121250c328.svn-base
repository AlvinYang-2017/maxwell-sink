package com.cimc.sink.db;

import com.cimc.maxwell.sink.db.SqlAssembler;
import com.cimc.maxwell.sink.row.RowMap;
import com.cimc.maxwell.sink.row.RowMapPK;

import java.util.HashMap;
import java.util.Map;

/**
 * Created by 00013708 on 2017/8/8.
 */
public class SqlAssemblerTest {


    @org.junit.Test
    public void getSqlTest(){
        SqlAssembler assembler = new SqlAssembler();
        RowMap insertRow = insertRow();

        RowMap updateRow = updateRow();

        RowMap deleteRow = deleteRow();
        RowMapPK rowMapPK = new RowMapPK();
        rowMapPK.setPk("id");
//        rowMapPK.setPkVal("100000A01120160629150388");
//        System.out.println(assembler.getSql(rowMapPK,insertRow));

//        System.out.println(assembler.getSql(updateRow));

//        System.out.println(assembler.getSql(deleteRow));
    }

    private RowMap insertRow() {
        RowMap rowMap = new RowMap();
        rowMap.setDatabase("db_ez");
        rowMap.setTable("t_parcel");
        rowMap.setType("insert");

        Map<String,String> data = new HashMap<>();
        data.put("id","100000A01120160629150388");
        data.put("sn","100000A011");
        data.put("box_id","DC_112");
        data.put("status","book");
        data.put("package_id","sx8888");
        data.put("pickup_mobile",null);
        rowMap.setData(data);
        return  rowMap;
    }

    private RowMap updateRow() {
        RowMap rowMap = new RowMap();
        rowMap.setDatabase("db_ez");
        rowMap.setTable("t_parcel");
        rowMap.setType("update");

        Map<String,String> data = new HashMap<>();
//        data.put("id","100000A01120160629150388");
        data.put("status","book");
        data.put("package_id","sx8888");
        data.put("pickup_mobile","1802536");
        rowMap.setData(data);

        Map<String,String> old = new HashMap<>();
        old.put("status","cancel");
        old.put("package_id","sx6666");
        old.put("pickup_mobile",null);
        rowMap.setOld(old);
        return  rowMap;
    }


    private RowMap deleteRow() {
        RowMap rowMap = new RowMap();
        rowMap.setDatabase("db_ez");
        rowMap.setTable("t_parcel");
        rowMap.setType("delete");

        Map<String,String> data = new HashMap<>();
//        data.put("id","100000A01120160629150388");
        data.put("status","book");
        data.put("package_id","sx8888");
        data.put("pickup_mobile","");
        rowMap.setData(data);

        Map<String,String> old = new HashMap<>();
        old.put("status","cancel");
        old.put("package_id","sx6666");
        old.put("pickup_mobile",null);
        rowMap.setOld(old);
        return  rowMap;

    }
}
